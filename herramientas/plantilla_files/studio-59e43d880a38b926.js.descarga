(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4450],{54874:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/studio",function(){return s(62092)}])},62092:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>eo});var l=s(74848),a=s(89806),o=s(62654),i=s(59473),r=s(92692),n=s(24545),c=s(88788),d=s(74622),p=s(66247),u=s(28556),h=s(19427),x=s(55935),j=s(94191),m=s(91703),y=s(1771),A=s(77568),g=s(78036),v=s(70258),k=s(39990),b=s(62322),w=s(60373),f=s(2424),S=s(3508),_=s(17319),C=s(66903),W=s(37915),D=s(64543),I=s(55451),P=s(23278),T=s(82058),R=s(47432),q=s(13368),B=s.n(q),E=s(86715),N=s(96540),F=s(37318),O=s(77515),L=s(80923),M=s(85617),z=s(58782),Y=s(47863),K=s(94598),U=s(55103),V=s(71501),Z=s(22689);let H={"/images/logos/html5.svg":5,"/images/logos/c2.svg":5},X=e=>{let{jobTitle:t,jobLocation:s,companyLogo:a,companyName:o,jobsCount:i,companyInfo:r,className:n,...c}=e;return(0,l.jsx)(V.A,{className:n,align:"left",...c,sx:e=>({height:"100%",width:"100%",cursor:"pointer",borderRadius:e.spacing(1)}),children:(0,l.jsx)(Z.A,{children:(0,l.jsx)(T.Ay,{container:!0,spacing:1,children:(0,l.jsx)(T.Ay,{item:!0,xs:12,children:(0,l.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(p.A,{variant:"h6",style:{fontWeight:500},children:o}),(0,l.jsx)(p.A,{component:"span",variant:"body2",color:"textSecondary",children:s})]}),(0,l.jsx)("div",{children:(0,l.jsx)(b.A,{style:{padding:H[a]||0,width:60,height:60},src:a,alt:o})})]})})})})})};var J=s(87976),G=s(49518),Q=s(63279),$=s(2317);let ee=[],et=["theme","apiKey","userApiToken"],es=["labels.studio","labels.logo"],el=e=>{let{title:t,value:s,previousValue:a}=e,o=null;a&&(o=Math.round(100*(o=Math.round((o=s-a)/a*100)))/100);let i=o>=0?"up":"down";return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(p.A,{variant:"body2",color:"textSecondary",children:t}),(0,l.jsxs)(T.Ay,{container:!0,alignItems:"center",children:[(0,l.jsx)(p.A,{variant:"h6",gutterBottom:!0,style:{marginRight:12,marginTop:4},children:s}),o&&(0,l.jsx)(T.Ay,{item:!0,children:(0,l.jsx)(u.A,{style:{borderRadius:4,backgroundColor:"up"===i?"rgb(24, 144, 255)":"rgb(250, 173, 20)",color:"white"},icon:"up"===i?(0,l.jsx)(n.A,{style:{color:"white"}}):(0,l.jsx)(r.A,{style:{color:"white"}}),label:"".concat(Math.abs(o),"%"),size:"small"})})]})]})},ea=e=>{var t;let s=(0,E.useRouter)(),r=(0,F.wA)(),n=(0,K.M)();s.query;let{userLoggedIn:u,token:q,_id:V,name:Z,theme:H,plan:ea,countryCode:eo}=(0,F.d4)(e=>e.user),ei=(0,F.d4)(e=>e.user.token),[er,en]=(0,N.useState)({}),[ec,ed]=(0,N.useState)(!1),[ep,eu]=(0,N.useState)(!1),[eh,ex]=(0,N.useState)(null),[ej,em]=(0,N.useState)(null),[ey,eA]=(0,N.useState)(!0),[eg,ev]=N.useState(!1),[ek,eb]=N.useState(!1),[ew,ef]=N.useState(""),[eS,e_]=(0,N.useState)(!!s.asPath.startsWith("/embed")),[eC,eW]=(0,N.useState)(null),[eD,eI]=(0,N.useState)(null),[eP,eT]=(0,N.useState)(!1),eR=()=>{eT(!1)},eq=async()=>{eb(!0),eT(!1);try{let{statusCode:e,error:t,json:s}=await (0,Y.RA)("/api/studio/deploy",ei,{...eD});200===e?(null==s?void 0:s.status)==="success"?(ex(eh.map(e=>e._id===eD._id?{...e,deployment:{appId:eD.deployment.appId,url:s.url}}:e)),alert("Workspace deployed successfully!")):alert("Failed to deploy workspace. "+s.error):alert(t)}finally{eb(!1)}};async function eB(e,t){let{statusCode:s,json:l}=await (0,Y.RA)("/api/v1/loginUser",null,{apiKey:e,userApiToken:t});200===s&&(null==l?void 0:l.status)==="success"?r((0,G.pH)(l,!0)):alert("API login failed. "+JSON.stringify(l||{}))}(0,N.useEffect)(()=>{if(s.asPath.startsWith("/embed")){let e={};for(let t of ee)s.query[t]&&"true"===s.query[t]&&(e[t]=!0);for(let t of et)s.query[t]&&(e[t]=s.query[t]);let t={};for(let e of es)s.query[e]&&(t[e]=s.query[e]);en(t),e.apiKey&&e.userApiToken&&eB(e.apiKey,e.userApiToken),e.theme&&e.theme!==n.theme&&n.onUpdate("theme",e.theme,!0)}},[]),(0,N.useEffect)(()=>{var e;let t=J[s.query.template];(null==t?void 0:null===(e=t.datasets)||void 0===e?void 0:e.length)>0&&ef(t.datasets[0].id)},[s.query.template]),(0,N.useEffect)(()=>{eS&&s.query.userApiToken&&!q||eE()},[q]);let eE=async()=>{eA(!0);let{statusCode:e,error:t,json:s}=await (0,Y.ZM)("/api/studio/workspaces",ei);200===e?ex(s=s.filter(e=>"deleted"!==e.status&&"delete_failed"!==e.status)):alert(t),eA(!1),ed(!0);let{json:l}=await (0,Y.ZM)("/api/studio/workspace/stats",ei);em(l)},eN=async e=>{if(ev(!0),"running"===e.status||"stopped"===e.status){if(eS){let{json:e}=await (0,Y.ZM)("/api/studio/verifyApiAccess",ei);if((null==e?void 0:e.access)!==!0){alert("Studio access has not been enabled for your API"),ev(!1);return}}Q.Router.pushRoute("/studio/".concat(e.template._id,"/").concat(e._id))}else"stopping"===e.status?alert("Workspace is stopping. Please try again in a minute."):alert("Workspace cannot be opened. Please contact support");ev(!1)},eF=async()=>{if(null===eC)return;console.log("Deleting workspace: ",eC);let e=await (0,Y.yH)("/api/studio/workspace/".concat(eC),ei,{});eW(null),e&&"success"===e.status?eE():alert("Failed to delete workspace")};return eS&&!ec?(0,l.jsx)(z.A,{}):!eS&&eo&&$.DISABLED_COUNTRY_CODES.includes(eo)?(0,l.jsx)(U.A,{}):(0,l.jsxs)(l.Fragment,{children:[!1===eS&&(0,l.jsx)(B(),{children:(0,l.jsx)("title",{children:"Studio - OneCompiler"})}),(0,l.jsxs)("div",{children:[(0,l.jsx)(h.A,{children:!1===eS&&(0,l.jsx)(L.A,{})}),eS&&(0,l.jsx)("div",{style:{marginTop:30}}),(0,l.jsxs)(P.A,{fixed:!0,component:"main",children:[(0,l.jsxs)(h.A,{children:[er["labels.logo"]?(0,l.jsx)(l.Fragment,{children:(0,l.jsx)("img",{style:{maxWidth:200,paddingBottom:20},src:er["labels.logo"]})}):(0,l.jsx)(p.A,{variant:"h3",component:"h1",color:"primary",gutterBottom:!0,children:er["labels.studio"]||"Studio"}),"enterprise"===ea&&!eS&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(Q.Link,{prefetch:!1,route:"/studio-admin",children:(0,l.jsx)(x.A,{color:"primary",children:"Studio Admin"})}),(0,l.jsx)(j.A,{})," ",(0,l.jsx)("br",{})]}),(0,l.jsx)(p.A,{variant:"body1",color:"textSecondary",children:"".concat(er["labels.studio"]||"Studio"," gives online Visual Studio Code environment to build projects. You can choose from the below readily available templates to start building your project. If the template you are looking for is not available, you can always create a new workspace from scratch using the Alpine template.\n                      ")}),(0,l.jsx)("br",{})," ",(0,l.jsx)("br",{})]}),(0,l.jsx)(p.A,{variant:"h5",component:"h1",color:"primary",gutterBottom:!0,children:"Your Workspaces"}),ey&&(0,l.jsx)(z.A,{}),!ey&&null!==eh&&(0,l.jsxs)(l.Fragment,{children:[(null==eh?void 0:eh.length)>0?(0,l.jsx)(p.A,{variant:"body1",color:"textSecondary",children:"Below, you'll find a list of your workspaces. Simply click on the workspace to resume your work"}):(0,l.jsx)(p.A,{variant:"body1",color:"textSecondary",children:"No workspaces found. You can always launch a new workspace from the above-listed templates"}),(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),(null==eh?void 0:eh.length)>0&&(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(m.A,{variant:"outlined",style:{borderBottom:"none"},children:(0,l.jsxs)(y.A,{"aria-label":"workspaces",children:[(0,l.jsx)(A.A,{sx:e=>({borderBottom:"2px solid ".concat("dark"===e.palette.mode?e.palette.grey[700]:e.palette.grey[200])}),children:(0,l.jsxs)(g.A,{children:[(0,l.jsx)(v.A,{children:"Template"}),(0,l.jsx)(v.A,{children:"Name"}),(0,l.jsx)(v.A,{children:"Status"}),(0,l.jsx)(v.A,{children:"Created"}),(0,l.jsx)(v.A,{align:"left",children:"Actions"})]})}),(0,l.jsx)(k.A,{children:eh.sort((e,t)=>new Date(t.created)-new Date(e.created)).map(e=>{var t,s;return(0,l.jsxs)(g.A,{sx:e=>({cursor:"pointer",borderBottom:"2px solid ".concat("dark"===e.palette.mode?e.palette.grey[800]:e.palette.grey[200]),"&:hover":{backgroundColor:"dark"===e.palette.mode?e.palette.grey[900]:e.palette.grey[100]}}),onClick:()=>eN(e),children:[(0,l.jsx)(v.A,{children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(b.A,{src:J[e.template._id].logo,sx:{width:"30px",height:"30px"}}),(0,l.jsx)(p.A,{style:{paddingLeft:14},variant:"subtitle1",children:J[e.template._id].title})]})}),(0,l.jsxs)(v.A,{children:[" ",e.name||e._id," "]}),(0,l.jsxs)(v.A,{children:[" ",e.status," "]}),(0,l.jsxs)(v.A,{children:[" ",(0,R.A)(new Date(e.created),{max:1,suffix:!0})," "]}),(0,l.jsxs)(v.A,{align:"left",children:["stopped"===e.status&&e.backup&&(0,l.jsx)(w.A,{title:"Download Backup",children:(0,l.jsx)(f.A,{onClick:t=>{t.stopPropagation(),window.open(e.backup,"_blank")},size:"large",children:(0,l.jsx)(o.A,{})})}),(0,l.jsx)(w.A,{title:"Delete Workspace",children:(0,l.jsx)(f.A,{onClick:t=>{t.stopPropagation(),eW(e._id)},size:"large",children:(0,l.jsx)(a.A,{})})}),(0,l.jsx)(w.A,{title:"Open Workspace",children:(0,l.jsx)(x.A,{color:"primary",onClick:t=>{t.stopPropagation(),eN(e)},endIcon:(0,l.jsx)(i.A,{}),children:"Open"})}),["angular","html","html-simple","react","vue"].includes(null==e?void 0:null===(t=e.template)||void 0===t?void 0:t._id)&&(0,l.jsx)(w.A,{title:"Deploy Workspace",children:(0,l.jsx)(f.A,{onClick:t=>{t.stopPropagation(),eT(!0),eI(e)},size:"large",children:(0,l.jsx)(c.A,{})})}),(null==e?void 0:null===(s=e.deployment)||void 0===s?void 0:s.url)&&(0,l.jsx)(w.A,{title:"Open live workspace",children:(0,l.jsx)(f.A,{onClick:t=>{t.stopPropagation(),window.open(e.deployment.url,"_blank")},size:"large",children:(0,l.jsx)(d.A,{})})})]})]},e._id)})})]})})})]}),(0,l.jsx)("br",{})," ",(0,l.jsx)("br",{}),(0,l.jsx)(p.A,{variant:"h5",component:"h1",color:"primary",children:"Templates"}),(0,l.jsx)("br",{}),(0,l.jsx)(T.Ay,{container:!0,spacing:6,children:Object.values(J).map(e=>(0,l.jsx)(T.Ay,{item:!0,xs:12,sm:6,md:4,lg:3,children:(0,l.jsx)("div",{onClick:()=>{Q.Router.pushRoute("".concat(eS?"/embed":"","/studio/").concat(e._id),{shallow:!0})},children:(0,l.jsx)(X,{variant:"outlined",companyName:e.title,jobTitle:e.status,jobLocation:e.vm,companyLogo:e.logo,jobsCount:"< 1 Minute",companyInfo:e.description,link:e.link,tags:e.tags})})},e._id))}),(0,l.jsx)("br",{}),(0,l.jsx)("br",{}),ej&&(0,l.jsxs)(T.Ay,{container:!0,children:[(0,l.jsx)(T.Ay,{item:!0,xs:6,md:2,children:(0,l.jsx)(el,{title:"Total Workspaces",value:ej.totalWorkspaces})}),(0,l.jsx)(T.Ay,{item:!0,xs:6,md:2,children:(0,l.jsx)(el,{title:"Last 7 Days",value:ej.totalWorkspacesLast7Days,previousValue:ej.totalWorkspacesLast7DaysPrevious})}),(0,l.jsx)(T.Ay,{item:!0,xs:6,md:2,children:(0,l.jsx)(el,{title:"Today",value:ej.totalWorkspacesToday,previousValue:ej.totalWorkspacesYesterday})}),(0,l.jsx)(T.Ay,{item:!0,xs:6,md:2,children:(0,l.jsx)(el,{title:"Live",value:ej.totalRunningWorkspaces})})]}),(0,l.jsx)(j.A,{style:{marginTop:2,marginBottom:10}}),(0,l.jsx)("br",{})]}),!1===eS&&(0,l.jsx)(O.A,{})]}),(0,l.jsx)(M.A,{open:eg,message:"Starting the workspace"}),(0,l.jsx)(M.A,{open:ek,message:"Deploying the workspace"}),(0,l.jsxs)(S.A,{open:null!=eC,onClose:()=>eW(null),children:[(0,l.jsx)(_.A,{children:"Do you want to delete the workspace?"}),(0,l.jsx)(C.A,{children:(0,l.jsx)(W.A,{children:"This action cannot be undone. Deleting the workspace will permanently remove all associated data, including projects, files and settings. Please confirm that you want to proceed with this irreversible action."})}),(0,l.jsxs)(D.A,{children:[(0,l.jsx)(x.A,{onClick:()=>eW(null),color:"primary",children:"Cancel"}),(0,l.jsx)(x.A,{onClick:()=>eF(),color:"primary",autoFocus:!0,children:"Delete"})]})]}),(0,l.jsxs)(S.A,{open:eP,onClose:eR,children:[(0,l.jsx)(_.A,{children:"Enter AppId"}),(0,l.jsxs)(C.A,{children:[(0,l.jsx)(W.A,{children:"Please enter the AppId to proceed with deployment."}),(0,l.jsx)(I.A,{autoFocus:!0,margin:"dense",label:"AppId",type:"text",fullWidth:!0,value:null==eD?void 0:null===(t=eD.deployment)||void 0===t?void 0:t.appId,onChange:e=>eI({...eD,deployment:{...eD.deployment,appId:e.target.value}})})]}),(0,l.jsxs)(D.A,{children:[(0,l.jsx)(x.A,{onClick:eR,color:"primary",children:"Cancel"}),(0,l.jsx)(x.A,{onClick:()=>{eq()},color:"primary",children:"Deploy"})]})]})]})};ea.getInitialProps=async e=>({foo:"temp fix for missing query"});let eo=ea}},e=>{var t=t=>e(e.s=t);e.O(0,[2058,7062,863,7840,8851,7862,2101,2350,655,8556,6799,4794,923,5103,636,6593,8792],()=>t(54874)),_N_E=e.O()}]);